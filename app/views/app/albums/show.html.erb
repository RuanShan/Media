<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, width=device-width">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta name="format-detection" content="telephone=no">
<meta content="telephone=no" name="format-detection"> 
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<title><%= @photo.album.try(:name) %></title>
  <link type="text/css" rel="stylesheet" href="/stylesheets/albums/photoswipe.css"/>
  <link type="text/css" rel="stylesheet" href="/stylesheets/albums/wphoto.css"/>
  <script src="/javascripts/app/albums/lib/klass.min.js"></script>
  <script src="/javascripts/app/albums/lib/code.util-1.0.6.min.js"></script>
  <script src="/javascripts/app/albums/lib/image.js"></script>
  <script src="/javascripts/app/albums/lib/image.class.js"></script>
  <script src="/javascripts/app/albums/lib/cache.js"></script>
  <script src="/javascripts/app/albums/lib/cache.class.js"></script>
  <script src="/javascripts/app/albums/lib/documentoverlay.js"></script>
  <script src="/javascripts/app/albums/lib/documentoverlay.class.js"></script>
  <script src="/javascripts/app/albums/lib/carousel.js"></script>
  <script src="/javascripts/app/albums/lib/carousel.class.js"></script>
  <script src="/javascripts/app/albums/lib/carousel.class.animation.js"></script>
  <script src="/javascripts/app/albums/lib/toolbar.js"></script>
  <script src="/javascripts/app/albums/lib/toolbar.class.js"></script>
  <script src="/javascripts/app/albums/lib/uilayer.js"></script>
  <script src="/javascripts/app/albums/lib/uilayer.class.js"></script>
  <script src="/javascripts/app/albums/lib/zoompanrotate.js"></script>
  <script src="/javascripts/app/albums/lib/zoompanrotate.class.js"></script>
  <script src="/javascripts/app/albums/lib/photoswipe.js"></script>
  <script src="/javascripts/app/albums/lib/photoswipe.class.js"></script>

  <script>
  (function(window, Util, PhotoSwipe){
      
      Util.Events.domReady(function(e){
        
        var instance1, instance2;
        
        instance1 = PhotoSwipe.attach(
          [
            <% @photos.each do |p| %>
            { url: '<%= p.pic.large %>', caption: '<%= p.name %>'},
            <% end %>
          ],
          {
            getImageSource: function(obj){
              return obj.url;
            },
            getImageCaption: function(obj){
              return obj.caption;
            }
          }
        );          

        instance1.show(<%= @index %>);
      });
      
      
    }(window, window.Code.Util, window.Code.PhotoSwipe));
  
    function closeShow(){
      // alert('ddd');
      // window.location.href="<%= app_albums_url(:aid => @photo.album.activity) %>";
      history.go(-1); 
    }
</script>
</head>
<body>
  <input type="hidden" id="chacha" value="<%= app_albums_url(:aid => @photo.album.activity.id) %>" />
</body>
</html>